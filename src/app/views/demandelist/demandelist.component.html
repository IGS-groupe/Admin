<div class="demande-table-wrapper">
 <div class="table-header d-flex justify-content-between align-items-center mb-3 flex-wrap gap-3">
    <button class="btn btn-primary shadow-sm" (click)="navigateToDemandeForm()">Add Request</button>
    <div class="d-flex flex-wrap gap-2">
  <!-- Filter Inputs -->
  <div class="filter-bar-multiple">
    <input
      type="text"
      class="form-control"
      placeholder="🔍 Search by request for..."
      [(ngModel)]="filterText"
      (input)="onFilterChange()" />

    <input
      type="text"
      class="form-control"
      placeholder="Purchase order..."
      [(ngModel)]="filterBon"
      (input)="onFilterChange()" />

    <select class="form-control" [(ngModel)]="filterLangue" (change)="onFilterChange()">
      <option value="">All languages</option>
      <option value="Français">French</option>
      <option value="Anglais">English</option>
     
    </select>
  </div>

  <!-- Empty State -->
  <div *ngIf="filteredDemandes.length === 0" class="empty-alert">
    <p>🚫 Aucune demande trouvée.</p>
  </div>

  <!-- Data Table -->
  <div *ngIf="filteredDemandes.length > 0" class="table-container">
    <table>
      <thead>
        <tr>
         <th>#</th>
        <th>Request For</th>
        <th>Sent to Laboratory</th>
        <th>Additional Emails</th>
        <th>Purchase Order</th>
        <th>Certificate Language</th>
        <th>Comments</th>
        <th>Action</th>

        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let demande of filteredDemandes; let i = index">
          <td>{{ demande.demandeId }}</td>
          <td>{{ demande.demandePour }}</td>
          <td>{{ demande.envoyeAuLaboratoire }}</td>
          <td>{{ demande.courrielsSupplementaires }}</td>
          <td>{{ demande.bonDeCommande }}</td>
          <td>{{ demande.langueDuCertificat }}</td>
          <td>{{ demande.commentairesInternes }}</td>
         <td>
            <div class="d-flex align-items-center gap-2 flex-wrap">
              <button class="btn details-btn" (click)="details(demande.demandeId!, demande.etat || '')">
                Details
              </button>

              <!-- Export to Excel selector -->
              <select
                class="form-select form-select-sm"
                [ngModel]="demande.exportExcel"
                (ngModelChange)="onExportExcelChange(demande, $event)"
              >
                <option [ngValue]="false">Do not export</option>
                <option [ngValue]="true">Export</option>
              </select>
            </div>
          </td>

        </tr>
      </tbody>
    </table>
  </div>
</div>
